2025-07-09 15:54:40,209 - aiq.eval.evaluate - INFO - Starting evaluation run with config file: configs/config-reasoning.yml
2025-07-09 15:54:40,390 - aiq.runtime.loader - WARNING - Loading module 'aiq.agent.register' from entry point 'aiq_agents' took a long time (148.586988 ms). Ensure all imports are inside your registered functions.
2025-07-09 15:54:40,547 - aiq.profiler.utils - WARNING - Discovered frameworks: {<LLMFrameworkEnum.LANGCHAIN: 'langchain'>} in function generate_sql_query_and_retrieve_tool by inspecting source. It is recommended and more reliable to instead add the used LLMFrameworkEnum types in the framework_wrappers argument when calling @register_function.
Discovered frameworks: {<LLMFrameworkEnum.LANGCHAIN: 'langchain'>} in function generate_sql_query_and_retrieve_tool by inspecting source. It is recommended and more reliable to instead add the used LLMFrameworkEnum types in the framework_wrappers argument when calling @register_function.
/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_nvidia_ai_endpoints/_common.py:181: UserWarning: An API key is required for the hosted NIM. This will become an error in the future.
  warnings.warn(
/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_nvidia_ai_endpoints/_common.py:217: UserWarning: Found nvidia/llama-3.3-nemotron-super-49b-v1 in available_models, but type is unknown and inference may fail.
  warnings.warn(
2025-07-09 15:54:42,094 - predictive_maintenance_agent.generate_sql_query_and_retrieve_tool - INFO - INSTANCE DEBUG: Creating Vanna instance with vector_store_path: /Users/vmodak/Documents/Projects_Tutorials_Demos/PredictiveMaintenance_AIQ/GenerativeAIExamples/industries/manufacturing/predictive_maintenance_agent/database
INSTANCE DEBUG: Creating Vanna instance with vector_store_path: /Users/vmodak/Documents/Projects_Tutorials_Demos/PredictiveMaintenance_AIQ/GenerativeAIExamples/industries/manufacturing/predictive_maintenance_agent/database
/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_nvidia_ai_endpoints/_common.py:181: UserWarning: An API key is required for the hosted NIM. This will become an error in the future.
  warnings.warn(
/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_nvidia_ai_endpoints/_common.py:217: UserWarning: Found nvidia/llama-3.3-nemotron-super-49b-v1 in available_models, but type is unknown and inference may fail.
  warnings.warn(
2025-07-09 15:54:42,334 - predictive_maintenance_agent.generate_sql_query_and_retrieve_tool - INFO - INSTANCE DEBUG: Created instance id: 6098770384
INSTANCE DEBUG: Created instance id: 6098770384
2025-07-09 15:54:42,334 - predictive_maintenance_agent.generate_sql_query_and_retrieve_tool - INFO - INSTANCE DEBUG: Instance type: <class 'predictive_maintenance_agent.vanna_util.NIMVanna'>
INSTANCE DEBUG: Instance type: <class 'predictive_maintenance_agent.vanna_util.NIMVanna'>
2025-07-09 15:54:42,334 - predictive_maintenance_agent.generate_sql_query_and_retrieve_tool - INFO - INSTANCE DEBUG: Initial allow_llm_to_see_data: True
INSTANCE DEBUG: Initial allow_llm_to_see_data: True
2025-07-09 15:54:42,338 - predictive_maintenance_agent.generate_sql_query_and_retrieve_tool - INFO - INSTANCE DEBUG: After explicit set allow_llm_to_see_data: True
INSTANCE DEBUG: After explicit set allow_llm_to_see_data: True
2025-07-09 15:54:42,338 - predictive_maintenance_agent.generate_sql_query_and_retrieve_tool - INFO - Vanna vector store already initialized.
Vanna vector store already initialized.
2025-07-09 15:54:42,338 - predictive_maintenance_agent.generate_sql_query_and_retrieve_tool - INFO - INSTANCE DEBUG: After existing instance set allow_llm_to_see_data: True
INSTANCE DEBUG: After existing instance set allow_llm_to_see_data: True
2025-07-09 15:54:42,338 - predictive_maintenance_agent.generate_sql_query_and_retrieve_tool - INFO - INSTANCE DEBUG: Final verification - hasattr allow_llm_to_see_data: True
INSTANCE DEBUG: Final verification - hasattr allow_llm_to_see_data: True
2025-07-09 15:54:42,338 - predictive_maintenance_agent.generate_sql_query_and_retrieve_tool - INFO - INSTANCE DEBUG: Final verification - getattr allow_llm_to_see_data: True
INSTANCE DEBUG: Final verification - getattr allow_llm_to_see_data: True
2025-07-09 15:54:42,338 - predictive_maintenance_agent.generate_sql_query_and_retrieve_tool - INFO - INSTANCE DEBUG: Final verification - vn_instance.__dict__ keys: ['config', 'run_sql_is_set', 'static_documentation', 'dialect', 'language', 'max_tokens', 'embedding_function', 'n_results_sql', 'n_results_documentation', 'n_results_ddl', 'chroma_client', 'documentation_collection', 'ddl_collection', 'sql_collection', 'temperature', 'client', 'model', 'allow_llm_to_see_data', 'n_results', 'run_sql']
INSTANCE DEBUG: Final verification - vn_instance.__dict__ keys: ['config', 'run_sql_is_set', 'static_documentation', 'dialect', 'language', 'max_tokens', 'embedding_function', 'n_results_sql', 'n_results_documentation', 'n_results_ddl', 'chroma_client', 'documentation_collection', 'ddl_collection', 'sql_collection', 'temperature', 'client', 'model', 'allow_llm_to_see_data', 'n_results', 'run_sql']
/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_nvidia_ai_endpoints/_common.py:181: UserWarning: An API key is required for the hosted NIM. This will become an error in the future.
  warnings.warn(
/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_nvidia_ai_endpoints/_common.py:181: UserWarning: An API key is required for the hosted NIM. This will become an error in the future.
  warnings.warn(
/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_nvidia_ai_endpoints/_common.py:217: UserWarning: Found nvidia/llama-3.3-nemotron-super-49b-v1 in available_models, but type is unknown and inference may fail.
  warnings.warn(
/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_nvidia_ai_endpoints/_common.py:181: UserWarning: An API key is required for the hosted NIM. This will become an error in the future.
  warnings.warn(
/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_nvidia_ai_endpoints/_common.py:217: UserWarning: Found nvidia/llama-3.3-nemotron-super-49b-v1 in available_models, but type is unknown and inference may fail.
  warnings.warn(
/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_nvidia_ai_endpoints/_common.py:181: UserWarning: An API key is required for the hosted NIM. This will become an error in the future.
  warnings.warn(
/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_nvidia_ai_endpoints/_common.py:217: UserWarning: Found nvidia/llama-3.3-nemotron-super-49b-v1 in available_models, but type is unknown and inference may fail.
  warnings.warn(
/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_nvidia_ai_endpoints/_common.py:181: UserWarning: An API key is required for the hosted NIM. This will become an error in the future.
  warnings.warn(
/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_nvidia_ai_endpoints/_common.py:217: UserWarning: Found nvidia/llama-3.3-nemotron-super-49b-v1 in available_models, but type is unknown and inference may fail.
  warnings.warn(
NIMVanna INIT: allow_llm_to_see_data = True
Running workflow:   0%|          | 0/1 [00:00<?, ?it/s]2025-07-09 15:54:47,434 - aiq.builder.function - ERROR - Error with ainvoke in function with input: What is the remaining useful life (RUL) of unit_number 59 in dataset FD001.
Traceback (most recent call last):
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/builder/function.py", line 118, in ainvoke
    result = await self._ainvoke(converted_input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/builder/function.py", line 280, in _ainvoke
    return await self._ainvoke_fn(value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/agent/reasoning_agent/reasoning_agent.py", line 202, in single_inner
    async for chunk in llm.astream(prompt):
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_core/language_models/chat_models.py", line 598, in astream
    async for chunk in self._astream(
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_core/language_models/chat_models.py", line 1175, in _astream
    item = await run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_core/runnables/config.py", line 616, in run_in_executor
    return await asyncio.get_running_loop().run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/asyncio/futures.py", line 287, in __await__
    yield self  # This tells Task to wait for completion.
    ^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/asyncio/tasks.py", line 349, in __wakeup
    future.result()
  File "/opt/anaconda3/envs/pdm/lib/python3.11/asyncio/futures.py", line 203, in result
    raise self._exception.with_traceback(self._exception_tb)
  File "/opt/anaconda3/envs/pdm/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_core/runnables/config.py", line 607, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_nvidia_ai_endpoints/chat_models.py", line 421, in _stream
    for response in self._client.get_req_stream(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_nvidia_ai_endpoints/_common.py", line 568, in get_req_stream
    self._try_raise(response)
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_nvidia_ai_endpoints/_common.py", line 467, in _try_raise
    raise Exception(f"{header}\n{body}") from None
Exception: [401] Unauthorized
Authentication failed
Please check or regenerate your API key.
Error with ainvoke in function with input: What is the remaining useful life (RUL) of unit_number 59 in dataset FD001.
Traceback (most recent call last):
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/builder/function.py", line 118, in ainvoke
    result = await self._ainvoke(converted_input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/builder/function.py", line 280, in _ainvoke
    return await self._ainvoke_fn(value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/agent/reasoning_agent/reasoning_agent.py", line 202, in single_inner
    async for chunk in llm.astream(prompt):
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_core/language_models/chat_models.py", line 598, in astream
    async for chunk in self._astream(
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_core/language_models/chat_models.py", line 1175, in _astream
    item = await run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_core/runnables/config.py", line 616, in run_in_executor
    return await asyncio.get_running_loop().run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/asyncio/futures.py", line 287, in __await__
    yield self  # This tells Task to wait for completion.
    ^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/asyncio/tasks.py", line 349, in __wakeup
    future.result()
  File "/opt/anaconda3/envs/pdm/lib/python3.11/asyncio/futures.py", line 203, in result
    raise self._exception.with_traceback(self._exception_tb)
  File "/opt/anaconda3/envs/pdm/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_core/runnables/config.py", line 607, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_nvidia_ai_endpoints/chat_models.py", line 421, in _stream
    for response in self._client.get_req_stream(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_nvidia_ai_endpoints/_common.py", line 568, in get_req_stream
    self._try_raise(response)
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_nvidia_ai_endpoints/_common.py", line 467, in _try_raise
    raise Exception(f"{header}\n{body}") from None
Exception: [401] Unauthorized
Authentication failed
Please check or regenerate your API key.
2025-07-09 15:54:47,497 - aiq.observability.async_otel_listener - WARNING - Not all spans were closed. Ensure all start events have a corresponding end event. Remaining: {'e7281a2c-847c-4de7-8b96-25262e70252f': _Span(name="nvidia/llama-3.3-nemotron-super-49b-v1", context=SpanContext(trace_id=0x43c142c7391f1e1c51f7c9515e012586, span_id=0x689c4f0223370ef3, trace_flags=0x01, trace_state=[], is_remote=False))}
Not all spans were closed. Ensure all start events have a corresponding end event. Remaining: {'e7281a2c-847c-4de7-8b96-25262e70252f': _Span(name="nvidia/llama-3.3-nemotron-super-49b-v1", context=SpanContext(trace_id=0x43c142c7391f1e1c51f7c9515e012586, span_id=0x689c4f0223370ef3, trace_flags=0x01, trace_state=[], is_remote=False))}
2025-07-09 15:54:47,498 - aiq.runtime.runner - ERROR - Error running workflow: [401] Unauthorized
Authentication failed
Please check or regenerate your API key.
Traceback (most recent call last):
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/runtime/runner.py", line 135, in result
    result = await self._entry_fn.ainvoke(self._input_message, to_type=to_type)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/builder/function.py", line 128, in ainvoke
    raise e
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/builder/function.py", line 118, in ainvoke
    result = await self._ainvoke(converted_input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/builder/function.py", line 280, in _ainvoke
    return await self._ainvoke_fn(value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/agent/reasoning_agent/reasoning_agent.py", line 202, in single_inner
    async for chunk in llm.astream(prompt):
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_core/language_models/chat_models.py", line 598, in astream
    async for chunk in self._astream(
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_core/language_models/chat_models.py", line 1175, in _astream
    item = await run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_core/runnables/config.py", line 616, in run_in_executor
    return await asyncio.get_running_loop().run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/asyncio/futures.py", line 287, in __await__
    yield self  # This tells Task to wait for completion.
    ^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/asyncio/tasks.py", line 349, in __wakeup
    future.result()
  File "/opt/anaconda3/envs/pdm/lib/python3.11/asyncio/futures.py", line 203, in result
    raise self._exception.with_traceback(self._exception_tb)
  File "/opt/anaconda3/envs/pdm/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_core/runnables/config.py", line 607, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_nvidia_ai_endpoints/chat_models.py", line 421, in _stream
    for response in self._client.get_req_stream(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_nvidia_ai_endpoints/_common.py", line 568, in get_req_stream
    self._try_raise(response)
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_nvidia_ai_endpoints/_common.py", line 467, in _try_raise
    raise Exception(f"{header}\n{body}") from None
Exception: [401] Unauthorized
Authentication failed
Please check or regenerate your API key.
Error running workflow: [401] Unauthorized
Authentication failed
Please check or regenerate your API key.
Traceback (most recent call last):
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/runtime/runner.py", line 135, in result
    result = await self._entry_fn.ainvoke(self._input_message, to_type=to_type)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/builder/function.py", line 128, in ainvoke
    raise e
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/builder/function.py", line 118, in ainvoke
    result = await self._ainvoke(converted_input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/builder/function.py", line 280, in _ainvoke
    return await self._ainvoke_fn(value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/agent/reasoning_agent/reasoning_agent.py", line 202, in single_inner
    async for chunk in llm.astream(prompt):
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_core/language_models/chat_models.py", line 598, in astream
    async for chunk in self._astream(
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_core/language_models/chat_models.py", line 1175, in _astream
    item = await run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_core/runnables/config.py", line 616, in run_in_executor
    return await asyncio.get_running_loop().run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/asyncio/futures.py", line 287, in __await__
    yield self  # This tells Task to wait for completion.
    ^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/asyncio/tasks.py", line 349, in __wakeup
    future.result()
  File "/opt/anaconda3/envs/pdm/lib/python3.11/asyncio/futures.py", line 203, in result
    raise self._exception.with_traceback(self._exception_tb)
  File "/opt/anaconda3/envs/pdm/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_core/runnables/config.py", line 607, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_nvidia_ai_endpoints/chat_models.py", line 421, in _stream
    for response in self._client.get_req_stream(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_nvidia_ai_endpoints/_common.py", line 568, in get_req_stream
    self._try_raise(response)
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_nvidia_ai_endpoints/_common.py", line 467, in _try_raise
    raise Exception(f"{header}\n{body}") from None
Exception: [401] Unauthorized
Authentication failed
Please check or regenerate your API key.
2025-07-09 15:54:47,505 - aiq.eval.evaluate - ERROR - Failed to run the workflow: [401] Unauthorized
Authentication failed
Please check or regenerate your API key.
Traceback (most recent call last):
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/eval/evaluate.py", line 92, in run_one
    base_output = await runner.result()
                  ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/runtime/runner.py", line 135, in result
    result = await self._entry_fn.ainvoke(self._input_message, to_type=to_type)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/builder/function.py", line 128, in ainvoke
    raise e
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/builder/function.py", line 118, in ainvoke
    result = await self._ainvoke(converted_input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/builder/function.py", line 280, in _ainvoke
    return await self._ainvoke_fn(value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/agent/reasoning_agent/reasoning_agent.py", line 202, in single_inner
    async for chunk in llm.astream(prompt):
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_core/language_models/chat_models.py", line 598, in astream
    async for chunk in self._astream(
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_core/language_models/chat_models.py", line 1175, in _astream
    item = await run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_core/runnables/config.py", line 616, in run_in_executor
    return await asyncio.get_running_loop().run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/asyncio/futures.py", line 287, in __await__
    yield self  # This tells Task to wait for completion.
    ^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/asyncio/tasks.py", line 349, in __wakeup
    future.result()
  File "/opt/anaconda3/envs/pdm/lib/python3.11/asyncio/futures.py", line 203, in result
    raise self._exception.with_traceback(self._exception_tb)
  File "/opt/anaconda3/envs/pdm/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_core/runnables/config.py", line 607, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_nvidia_ai_endpoints/chat_models.py", line 421, in _stream
    for response in self._client.get_req_stream(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_nvidia_ai_endpoints/_common.py", line 568, in get_req_stream
    self._try_raise(response)
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_nvidia_ai_endpoints/_common.py", line 467, in _try_raise
    raise Exception(f"{header}\n{body}") from None
Exception: [401] Unauthorized
Authentication failed
Please check or regenerate your API key.
Failed to run the workflow: [401] Unauthorized
Authentication failed
Please check or regenerate your API key.
Traceback (most recent call last):
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/eval/evaluate.py", line 92, in run_one
    base_output = await runner.result()
                  ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/runtime/runner.py", line 135, in result
    result = await self._entry_fn.ainvoke(self._input_message, to_type=to_type)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/builder/function.py", line 128, in ainvoke
    raise e
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/builder/function.py", line 118, in ainvoke
    result = await self._ainvoke(converted_input)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/builder/function.py", line 280, in _ainvoke
    return await self._ainvoke_fn(value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/agent/reasoning_agent/reasoning_agent.py", line 202, in single_inner
    async for chunk in llm.astream(prompt):
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_core/language_models/chat_models.py", line 598, in astream
    async for chunk in self._astream(
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_core/language_models/chat_models.py", line 1175, in _astream
    item = await run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_core/runnables/config.py", line 616, in run_in_executor
    return await asyncio.get_running_loop().run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/asyncio/futures.py", line 287, in __await__
    yield self  # This tells Task to wait for completion.
    ^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/asyncio/tasks.py", line 349, in __wakeup
    future.result()
  File "/opt/anaconda3/envs/pdm/lib/python3.11/asyncio/futures.py", line 203, in result
    raise self._exception.with_traceback(self._exception_tb)
  File "/opt/anaconda3/envs/pdm/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_core/runnables/config.py", line 607, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_nvidia_ai_endpoints/chat_models.py", line 421, in _stream
    for response in self._client.get_req_stream(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_nvidia_ai_endpoints/_common.py", line 568, in get_req_stream
    self._try_raise(response)
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/langchain_nvidia_ai_endpoints/_common.py", line 467, in _try_raise
    raise Exception(f"{header}\n{body}") from None
Exception: [401] Unauthorized
Authentication failed
Please check or regenerate your API key.
Running workflow: 100%|██████████| 1/1 [00:00<00:00,  3.97it/s]Running workflow: 100%|██████████| 1/1 [00:00<00:00,  3.97it/s]
2025-07-09 15:54:47,507 - aiq.eval.evaluate - ERROR - An error occurred while running evaluator rag_accuracy: 1 validation error for SingleTurnSample
reference
  Input should be a valid string [type=string_type, input_value=114, input_type=int]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
Traceback (most recent call last):
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/eval/evaluate.py", line 211, in run_single_evaluator
    eval_output = await evaluator.evaluate_fn(self.eval_input)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/eval/rag_evaluator/register.py", line 115, in evaluate_fn
    return await _evaluator.evaluate(eval_input)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/eval/rag_evaluator/evaluate.py", line 120, in evaluate
    ragas_dataset = self.eval_input_to_ragas(eval_input)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/eval/rag_evaluator/evaluate.py", line 62, in eval_input_to_ragas
    sample = SingleTurnSample(
             ^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/pydantic/main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for SingleTurnSample
reference
  Input should be a valid string [type=string_type, input_value=114, input_type=int]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
An error occurred while running evaluator rag_accuracy: 1 validation error for SingleTurnSample
reference
  Input should be a valid string [type=string_type, input_value=114, input_type=int]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
Traceback (most recent call last):
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/eval/evaluate.py", line 211, in run_single_evaluator
    eval_output = await evaluator.evaluate_fn(self.eval_input)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/eval/rag_evaluator/register.py", line 115, in evaluate_fn
    return await _evaluator.evaluate(eval_input)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/eval/rag_evaluator/evaluate.py", line 120, in evaluate
    ragas_dataset = self.eval_input_to_ragas(eval_input)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/eval/rag_evaluator/evaluate.py", line 62, in eval_input_to_ragas
    sample = SingleTurnSample(
             ^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/pydantic/main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for SingleTurnSample
reference
  Input should be a valid string [type=string_type, input_value=114, input_type=int]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-07-09 15:54:47,523 - aiq.eval.evaluate - ERROR - An error occurred while running evaluator rag_groundedness: 1 validation error for SingleTurnSample
reference
  Input should be a valid string [type=string_type, input_value=114, input_type=int]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
Traceback (most recent call last):
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/eval/evaluate.py", line 211, in run_single_evaluator
    eval_output = await evaluator.evaluate_fn(self.eval_input)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/eval/rag_evaluator/register.py", line 115, in evaluate_fn
    return await _evaluator.evaluate(eval_input)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/eval/rag_evaluator/evaluate.py", line 120, in evaluate
    ragas_dataset = self.eval_input_to_ragas(eval_input)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/eval/rag_evaluator/evaluate.py", line 62, in eval_input_to_ragas
    sample = SingleTurnSample(
             ^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/pydantic/main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for SingleTurnSample
reference
  Input should be a valid string [type=string_type, input_value=114, input_type=int]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
An error occurred while running evaluator rag_groundedness: 1 validation error for SingleTurnSample
reference
  Input should be a valid string [type=string_type, input_value=114, input_type=int]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
Traceback (most recent call last):
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/eval/evaluate.py", line 211, in run_single_evaluator
    eval_output = await evaluator.evaluate_fn(self.eval_input)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/eval/rag_evaluator/register.py", line 115, in evaluate_fn
    return await _evaluator.evaluate(eval_input)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/eval/rag_evaluator/evaluate.py", line 120, in evaluate
    ragas_dataset = self.eval_input_to_ragas(eval_input)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/eval/rag_evaluator/evaluate.py", line 62, in eval_input_to_ragas
    sample = SingleTurnSample(
             ^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/pydantic/main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for SingleTurnSample
reference
  Input should be a valid string [type=string_type, input_value=114, input_type=int]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-07-09 15:54:47,523 - aiq.eval.evaluate - ERROR - An error occurred while running evaluator rag_relevance: 1 validation error for SingleTurnSample
reference
  Input should be a valid string [type=string_type, input_value=114, input_type=int]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
Traceback (most recent call last):
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/eval/evaluate.py", line 211, in run_single_evaluator
    eval_output = await evaluator.evaluate_fn(self.eval_input)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/eval/rag_evaluator/register.py", line 115, in evaluate_fn
    return await _evaluator.evaluate(eval_input)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/eval/rag_evaluator/evaluate.py", line 120, in evaluate
    ragas_dataset = self.eval_input_to_ragas(eval_input)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/eval/rag_evaluator/evaluate.py", line 62, in eval_input_to_ragas
    sample = SingleTurnSample(
             ^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/pydantic/main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for SingleTurnSample
reference
  Input should be a valid string [type=string_type, input_value=114, input_type=int]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
An error occurred while running evaluator rag_relevance: 1 validation error for SingleTurnSample
reference
  Input should be a valid string [type=string_type, input_value=114, input_type=int]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
Traceback (most recent call last):
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/eval/evaluate.py", line 211, in run_single_evaluator
    eval_output = await evaluator.evaluate_fn(self.eval_input)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/eval/rag_evaluator/register.py", line 115, in evaluate_fn
    return await _evaluator.evaluate(eval_input)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/eval/rag_evaluator/evaluate.py", line 120, in evaluate
    ragas_dataset = self.eval_input_to_ragas(eval_input)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/eval/rag_evaluator/evaluate.py", line 62, in eval_input_to_ragas
    sample = SingleTurnSample(
             ^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/pydantic/main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for SingleTurnSample
reference
  Input should be a valid string [type=string_type, input_value=114, input_type=int]
    For further information visit https://errors.pydantic.dev/2.10/v/string_type
2025-07-09 15:54:47,523 - predictive_maintenance_agent.predict_rul_tool - INFO - Cleaning up predict_rul_tool workflow.
2025-07-09 15:54:47,523 - predictive_maintenance_agent.generate_sql_query_and_retrieve_tool - INFO - Cleaning up generate_sql_query_and_retrieve_tool workflow.
2025-07-09 15:54:47,546 - aiq.profiler.profile_runner - INFO - Wrote combined data to: /Users/vmodak/Documents/Projects_Tutorials_Demos/PredictiveMaintenance_AIQ/GenerativeAIExamples/industries/manufacturing/predictive_maintenance_agent/eval_output/all_requests_profiler_traces.json
2025-07-09 15:54:47,548 - aiq.profiler.profile_runner - INFO - Wrote merged standardized DataFrame to /Users/vmodak/Documents/Projects_Tutorials_Demos/PredictiveMaintenance_AIQ/GenerativeAIExamples/industries/manufacturing/predictive_maintenance_agent/eval_output/standardized_data_all.csv
2025-07-09 15:54:47,548 - aiq.profiler.profile_runner - WARNING - No data points for Workflow Run Time, cannot compute intervals.
2025-07-09 15:54:47,548 - aiq.profiler.profile_runner - WARNING - No data points for LLM Latency, cannot compute intervals.
Traceback (most recent call last):
  File "/opt/anaconda3/envs/pdm/bin/aiq", line 10, in <module>
    sys.exit(run_cli())
             ^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/cli/main.py", line 40, in run_cli
    cli(obj={}, auto_envvar_prefix='AIQ', show_default=True, prog_name="aiq")
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/click/core.py", line 1442, in __call__
    return self.main(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/click/core.py", line 1363, in main
    rv = self.invoke(ctx)
         ^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/click/core.py", line 1830, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/click/core.py", line 1809, in invoke
    return _process_result([] if self.chain else rv)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/click/core.py", line 1799, in _process_result
    value = ctx.invoke(self._result_callback, value, **ctx.params)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/click/core.py", line 794, in invoke
    return callback(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/cli/commands/evaluate.py", line 139, in process_aiq_eval
    asyncio.run(run_and_evaluate(config))
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/nest_asyncio.py", line 98, in run_until_complete
    return f.result()
           ^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/asyncio/futures.py", line 203, in result
    raise self._exception.with_traceback(self._exception_tb)
  File "/opt/anaconda3/envs/pdm/lib/python3.11/asyncio/tasks.py", line 277, in __step
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/cli/commands/evaluate.py", line 95, in run_and_evaluate
    await eval_runner.run_and_evaluate()
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/eval/evaluate.py", line 310, in run_and_evaluate
    await self.profile_workflow()
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/eval/evaluate.py", line 166, in profile_workflow
    await profiler_runner.run(all_stats)
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/profiler/profile_runner.py", line 163, in run
    prefixes = get_common_prefixes(all_steps, self.profile_config.prompt_caching_prefixes.min_frequency)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/pdm/lib/python3.11/site-packages/aiq/profiler/inference_optimization/prompt_caching.py", line 116, in get_common_prefixes
    raise ValueError(f"DataFrame missing required columns: {missing}")
ValueError: DataFrame missing required columns: {'framework', 'llm_text_input', 'llm_name'}
